<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Crop Advisory System</title>
<style>
body { font-family: Arial, sans-serif; background: #f9fff4; margin:0; padding:0; }
header { background: #2e7d32; color: white; text-align: center; padding: 1rem; }
.container { padding: 1rem; }
.card { background: white; padding: 1rem; margin-bottom: 1rem; border-radius: 10px; box-shadow: 0px 2px 8px rgba(0,0,0,0.1); }
button { background: #2e7d32; color: white; border: none; padding: 10px; margin-top: 10px; border-radius: 5px; cursor: pointer; width: 100%; font-size: 1rem; }
button:hover { background: #1b5e20; }
input[type="text"], select, input[type="file"] { padding: 8px; width: 100%; margin-top: 10px; border-radius: 5px; border: 1px solid #ccc; font-size: 1rem; }
p { font-size: 1rem; margin-top: 0.5rem; }
img { max-width: 100%; margin-top: 10px; border-radius: 10px; }
</style>
</head>
<body>

<header>
  <h1 id="appTitle"></h1>
  <p id="appSubtitle"></p>
</header>

<div class="container">

  <!-- Language Selection -->
  <div class="card">
    <h2 id="langTitle"></h2>
    <select id="langSelect" onchange="changeLanguage()">
      <option value="en">English</option>
      <option value="ta">родрооро┐ро┤рпН (Tamil)</option>
      <option value="ml">р┤ор┤▓р┤пр┤╛р┤│р┤В (Malayalam)</option>
      <option value="kn">р▓Хр▓ир│Нр▓ир▓б (Kannada)</option>
      <option value="te">р░др▒Жр░▓р▒Бр░Чр▒Б (Telugu)</option>
    </select>
  </div>

  <!-- Crop Input Section -->
  <div class="card">
    <h2 id="cropTitle"></h2>
    <input type="text" id="cropInput" placeholder="">
    <button id="submitBtn" onclick="submitCrop()"></button>
    <button id="voiceBtn" onclick="startRecognition()"></button>
    <p><b id="chosenLabel"></b> <span id="voiceText">---</span></p>
    <p id="adviceResult" style="color: green; font-weight: bold;"></p>
  </div>

  <!-- Image Upload Section -->
  <div class="card">
    <h2 id="imageTitle"></h2>
    <input type="file" id="cropImage" accept="image/*">
    <button id="analyzeBtn" onclick="analyzeImage()"></button>
    <p id="imageResult" style="color: darkorange; font-weight: bold;"></p>
    <img id="previewImg" src="" alt="">
  </div>

  <!-- Location + Weather + Mandi Prices -->
  <div class="card">
    <h2 id="locationTitle"></h2>
    <button id="locationBtn" onclick="getLocation()"></button>
    <p id="locationResult">---</p>
    <p id="weatherResult" style="color: blue; font-weight: bold;"></p>
    <p id="marketResult" style="color: brown; font-weight: bold;"></p>
  </div>

</div>

<script>
// ------------------- Multi-language Dictionary -------------------
let currentLang = "en";
let currentCrop = "";

const translations = {
  en: { 
    appTitle: "ЁЯМ▒ Smart Crop Advisory System",
    appSubtitle: "Voice/Typing + Multi-language + Weather + Mandi Prices + Image Suggestions",
    langTitle: "Select Language",
    cropTitle: "Enter or Speak Your Crop Name",
    cropPlaceholder: "Type crop name",
    submitBtn: "Submit Crop",
    voiceBtn: "ЁЯОд Speak Crop Name",
    chosenLabel: "You chose:",
    imageTitle: "Upload Crop Image for Suggestions",
    analyzeBtn: "Analyze Image",
    locationTitle: "ЁЯУН Your Location & Weather & Mandi Prices",
    locationBtn: "Get My Weather & Mandi Prices",
    alerts: { emptyCrop:"Please type a crop name or use voice input.", emptyImage:"Please upload an image first.", voiceError:"Voice recognition error.", enterCropForLocation:"Please enter or speak a crop first.", locationNotSupported:"Geolocation is not supported by your browser.", locationDenied:"Location access is required to use this app." },
    advisories: { wheat:"For Wheat: Irrigate lightly this week and apply nitrogen fertilizer.", rice:"For Rice: Maintain standing water and check for pests.", maize:"For Maize: Ensure soil moisture, apply potash at knee-high stage.", general:"General Tip: Use organic manure and monitor pests regularly." },
    imageSuggestions:["Yellow leaves тЖТ possible nitrogen deficiency.","Brown spots тЖТ possible fungal infection.","Curling leaves тЖТ possible water stress.","Healthy тЖТ keep following current practices."],
    mandiMessage:(crop, price)=>`Current mandi price of ${crop}: тВ╣${price} per quintal`,
    weatherTips:{hot:"High heat, irrigate crops adequately.", humid:"High humidity, watch for fungal diseases.", normal:"Normal weather, continue regular practices."}
  },
  ta: {
    appTitle: "ЁЯМ▒ рокрпБродрпНродрпБрогро░рпНро╡рпБ рокропро┐ро░рпН роЖро▓рпЛроЪройрпИ роорпБро▒рпИроорпИ",
    appSubtitle: "роХрпБро░ро▓рпН/родроЯрпНроЯроЪрпНроЪрпБ + рокро▓ роорпКро┤ро┐роХро│рпН + ро╡ро╛ройро┐ро▓рпИ + роорогрпНроЯро┐ ро╡ро┐ро▓рпИ + рокроЯ роЖро▓рпЛроЪройрпИ",
    langTitle: "роорпКро┤ро┐ропрпИ родрпЗро░рпНроирпНродрпЖроЯрпБ",
    cropTitle: "роЙроЩрпНроХро│рпН рокропро┐ро░рпН рокрпЖропро░рпИ родроЯрпНроЯроЪрпНроЪрпБ роЪрпЖропрпНропро╡рпЛ роЕро▓рпНро▓родрпБ рокрпЗроЪро╡рпЛ роЪрпЖропрпНропро╡рпБроорпН",
    cropPlaceholder: "рокропро┐ро░рпН рокрпЖропро░рпИ родроЯрпНроЯроЪрпНроЪрпБ роЪрпЖропрпНропро╡рпБроорпН",
    submitBtn: "рокропро┐ро░рпН роЪрооро░рпНрокрпНрокро┐роХрпНроХро╡рпБроорпН",
    voiceBtn: "ЁЯОд роХрпБро░ро▓рпН роорпВро▓роорпН рокрпЖропро░рпИ роЪрпКро▓рпНро▓ро╡рпБроорпН",
    chosenLabel: "роирпАроЩрпНроХро│рпН родрпЗро░рпНроирпНродрпЖроЯрпБродрпНродродрпБ:",
    imageTitle: "рокропро┐ро░рпН рокроЯродрпНродрпИ рокродро┐ро╡рпЗро▒рпНро▒ро╡рпБроорпН",
    analyzeBtn: "рокроЯродрпНродрпИ рокроХрпБрокрпНрокро╛ропрпНро╡рпБ роЪрпЖропрпНропро╡рпБроорпН",
    locationTitle: "ЁЯУН роЙроЩрпНроХро│рпН роЗроЯроорпН & ро╡ро╛ройро┐ро▓рпИ & роорогрпНроЯро┐ ро╡ро┐ро▓рпИ",
    locationBtn: "роОройрпН ро╡ро╛ройро┐ро▓рпИ рооро▒рпНро▒рпБроорпН роорогрпНроЯро┐ ро╡ро┐ро▓рпИ рокрпЖро▒ро╡рпБроорпН",
    alerts:{ emptyCrop:"родропро╡рпБроЪрпЖропрпНродрпБ рокропро┐ро░рпН рокрпЖропро░рпИ родроЯрпНроЯроЪрпНроЪрпБ роЪрпЖропрпНропро╡рпБроорпН роЕро▓рпНро▓родрпБ роХрпБро░ро▓рпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН.", emptyImage:"родропро╡рпБроЪрпЖропрпНродрпБ рокроЯродрпНродрпИ роорпБродро▓ро┐ро▓рпН рокродро┐ро╡рпЗро▒рпНро▒ро╡рпБроорпН.", voiceError:"роХрпБро░ро▓рпН роЕроЩрпНроХрпАроХро╛ро░роорпН рокро┐ро┤рпИ.", enterCropForLocation:"родропро╡рпБроЪрпЖропрпНродрпБ роорпБродро▓ро┐ро▓рпН рокропро┐ро░рпН рокрпЖропро░рпИ родроЯрпНроЯроЪрпНроЪрпБ роЪрпЖропрпНропро╡рпБроорпН роЕро▓рпНро▓родрпБ роЪрпКро▓рпНро▓ро╡рпБроорпН.", locationNotSupported:"роЙроЩрпНроХро│рпН роЙро▓ро╛ро╡ро┐ропро┐ро▓рпН роЗроЯродрпНродрпИроХрпН роХрогрпНроЯро▒ро┐родро▓рпН роЖродро░ро┐роХрпНроХро╡ро┐ро▓рпНро▓рпИ.", locationDenied:"роЗроирпНрод рокропройрпНрокро╛роЯрпНроЯрпИрокрпН рокропройрпНрокроЯрпБродрпНрод роЗроЯ роЕройрпБроородро┐ родрпЗро╡рпИ."},
    advisories:{ wheat:"роХрпЛродрпБроорпИ: роЗроирпНрод ро╡ро╛ро░роорпН роЪро┐ро▒ро┐родрпБ роирпАро░рпН роКроЯрпНроЯро╡рпБроорпН, роирпИроЯрпНро░роЬройрпН роЙро░роорпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН.", rice:"роЕро░ро┐роЪро┐: роиро┐ро▓родрпНродро┐ро▓рпН роирпАро░рпН роиро┐ро▓рпИродрпНродро┐ро░рпБроХрпНроХроЯрпНроЯрпБроорпН, рокрпВроЪрпНроЪро┐роХро│рпН рокро░ро┐роЪрпЛродро┐роХрпНроХро╡рпБроорпН.", maize:"роороХрпНроХро┐: роорогрпНрогро┐ро▓рпН роИро░рокрпНрокродроорпН роЙро▒рпБродро┐ роЪрпЖропрпНропро╡рпБроорпН, роЗроЯро┐ропро│ро╡рпБ роЕро│ро╡ро┐ро▓рпН рокрпКроЯрпНроЯро╛ро╖рпН роХрпКроЯрпБроХрпНроХро╡рпБроорпН.", general:"рокрпКродрпБ роЖро▓рпЛроЪройрпИ: роЙропро┐ро░ро┐ропро▓рпН роЙро░роорпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН, рокрпВроЪрпНроЪро┐роХро│рпН роХрогрпНроХро╛рогро┐роХрпНроХро╡рпБроорпН."},
    imageSuggestions:["роороЮрпНроЪро│рпН роЗро▓рпИроХро│рпН тЖТ роирпИроЯрпНро░роЬройрпН роХрпБро▒рпИро╡рпБ роЗро░рпБроХрпНроХро▓ро╛роорпН.","рокро┤рпБрокрпНрокрпБ рокрпБро│рпНро│ро┐роХро│рпН тЖТ рокрпВроЮрпНроЪрпИ роирпЛропрпН роЗро░рпБроХрпНроХро▓ро╛роорпН.","ро╡ро│рпИроирпНрод роЗро▓рпИроХро│рпН тЖТ роирпАро░рпН роХрпБро▒рпИро╡рпБ роЗро░рпБроХрпНроХро▓ро╛роорпН.","роиро▓рооро╛ройродрпБ тЖТ родро▒рпНрокрпЛродрпИроп роироЯрпИроорпБро▒рпИропрпИ родрпКроЯро░ро╡рпБроорпН."],
    mandiMessage:(crop, price)=>`${crop} роЗройрпН родро▒рпНрокрпЛродрпИроп роорогрпНроЯро┐ ро╡ро┐ро▓рпИ: тВ╣${price} роХро┐ро▓рпЛроХрпНроХрпБ`,
    weatherTips:{hot:"роЙропро░рпН ро╡рпЖрокрпНрокроорпН, рокропро┐ро░рпБроХрпНроХрпБ рокрпЛродрпБрооро╛рой роирпАро░рпН роКроЯрпНроЯро╡рпБроорпН.", humid:"роЙропро░рпН роИро░рокрпНрокродроорпН, рокрпВроЮрпНроЪрпИ роирпЛропрпНроХро│рпБроХрпНроХрпБ роХро╡ройроорпН ро╡рпИропрпБроЩрпНроХро│рпН.", normal:"роЪро╛родро╛ро░рог ро╡ро╛ройро┐ро▓рпИ, ро╡ро┤роХрпНроХрооро╛рой роироЯрпИроорпБро▒рпИ родрпКроЯро░ро╡рпБроорпН."}
  },
  // Add ml, kn, te similarly...
};

// ------------------- UI Functions -------------------
function changeLanguage() {
  const tr = translations[currentLang = document.getElementById("langSelect").value];
  document.getElementById("appTitle").innerText = tr.appTitle;
  document.getElementById("appSubtitle").innerText = tr.appSubtitle;
  document.getElementById("langTitle").innerText = tr.langTitle;
  document.getElementById("cropTitle").innerText = tr.cropTitle;
  document.getElementById("cropInput").placeholder = tr.cropPlaceholder;
  document.getElementById("submitBtn").innerText = tr.submitBtn;
  document.getElementById("voiceBtn").innerText = tr.voiceBtn;
  document.getElementById("chosenLabel").innerText = tr.chosenLabel;
  document.getElementById("imageTitle").innerText = tr.imageTitle;
  document.getElementById("analyzeBtn").innerText = tr.analyzeBtn;
  document.getElementById("locationTitle").innerText = tr.locationTitle;
  document.getElementById("locationBtn").innerText = tr.locationBtn;
}

// ------------------- Crop Submit -------------------
function submitCrop() {
  const crop = document.getElementById("cropInput").value.trim().toLowerCase();
  currentCrop = crop;
  if (!crop) { alert(translations[currentLang].alerts.emptyCrop); return; }
  document.getElementById("adviceResult").innerText = translations[currentLang].advisories[crop] || translations[currentLang].advisories.general;
}

// ------------------- Voice Recognition -------------------
function startRecognition() {
  if (!('webkitSpeechRecognition' in window)) { alert(translations[currentLang].alerts.voiceError); return; }
  let recognition = new webkitSpeechRecognition();
  const langMap = {en:'en-US', ta:'ta-IN', ml:'ml-IN', kn:'kn-IN', te:'te-IN'};
  recognition.lang = langMap[currentLang] || 'en-US';
  recognition.onresult = function(event) {
    const text = event.results[0][0].transcript;
    document.getElementById("cropInput").value = text;
    document.getElementById("voiceText").innerText = text;
    submitCrop();
  };
  recognition.onerror = function() { alert(translations[currentLang].alerts.voiceError); };
  recognition.start();
}

// ------------------- Image Analyze -------------------
function analyzeImage() {
  const imgInput = document.getElementById("cropImage");
  if (!imgInput.files.length) { alert(translations[currentLang].alerts.emptyImage); return; }
  const suggestions = translations[currentLang].imageSuggestions;
  const randomSuggestion = suggestions[Math.floor(Math.random()*suggestions.length)];
  document.getElementById("imageResult").innerText = randomSuggestion;
  const reader = new FileReader();
  reader.onload = function(e){ document.getElementById("previewImg").src = e.target.result; }
  reader.readAsDataURL(imgInput.files[0]);
}

// ------------------- Location -------------------
function getLocation() {
  if (!currentCrop) { alert(translations[currentLang].alerts.enterCropForLocation); return; }
  navigator.geolocation.getCurrentPosition(
    pos => {
      const lat = pos.coords.latitude, lon = pos.coords.longitude;
      document.getElementById("locationResult").innerText = `Lat: ${lat}, Lon: ${lon}`;
      document.getElementById("weatherResult").innerText = translations[currentLang].weatherTips.normal;
      document.getElementById("marketResult").innerText = translations[currentLang].mandiMessage(currentCrop, Math.floor(Math.random()*5000)+1000);
    },
    err => alert(translations[currentLang].alerts.locationDenied)
  );
}

// ------------------- Location Access Check -------------------
function checkLocationAccess() {
  if (!navigator.geolocation) { alert(translations[currentLang].alerts.locationNotSupported); disableApp(); return; }
  navigator.geolocation.getCurrentPosition(enableApp, err => { alert(translations[currentLang].alerts.locationDenied); disableApp(); });
}

function disableApp() { document.querySelectorAll("input, button, select").forEach(e=>e.disabled=true); }
function enableApp() { document.querySelectorAll("input, button, select").forEach(e=>e.disabled=false); }

// ------------------- Initialize -------------------
window.onload = function() { changeLanguage(); checkLocationAccess(); };
</script>

</body>
</html>
